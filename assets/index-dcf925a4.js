import{d as O,u as J,a as K,r as u,c as r,o as Q,g as p,b as m,e as a,w as i,h as s,f as l,j as W,m as X,q as D,t as _,a2 as Y,F as Z,l as ee,ac as M,s as b,v as h,i as te,x as se,k as oe,O as ne,z as ae,A as re,B as ie,_ as le}from"./index-ff671c6d.js";/* empty css             *//* empty css               *//* empty css            */import{u as ce}from"./usePartnerStore-c5291516.js";import{useTreeStore as de}from"./treeStore-474ae5e3.js";import{_ as ue}from"./dbc_category_drawer.vue_vue_type_style_index_0_lang-8d2b3df4.js";import{Descriptions as v}from"./descriptions-75cc912d.js";import{N as pe}from"./NavBar-fa151205.js";import{_ as me}from"./SelectMyStores.vue_vue_type_script_setup_true_lang-9c8688a8.js";/* empty css              *//* empty css              */import"./tree_cat_sub_products-fe3fe5e4.js";/* empty css                 *//* empty css                     */import"./CubeOverlay-af736554.js";import"./FilterComponent-81a90014.js";/* empty css            *//* empty css               *//* empty css                *//* empty css               */import"./SelectedProductsSummary-5cb2545f.js";/* empty css                  *//* empty css               *//* empty css              *//* empty css                          */import"./useMyStoreStats-6b9c8885.js";const N=f=>(re("data-v-3b2d5123"),f=f(),ie(),f),_e={style:{width:"100%","justify-content":"space-around",display:"flex","flex-direction":"column","align-items":"center"}},fe={class:"flex items-center space-x-2"},ge={key:"supplier",class:"button-container"},ve={class:"button-grid"},Se=["onClick"],ye={key:"confirm",class:"button-container"},be={class:"mb-4 space-y-2"},he=N(()=>s("span",{class:"mr-2"},"Мой магазин:",-1)),ke=N(()=>s("span",{class:"mr-2"},"Партнерский магазин:",-1)),xe={class:"button-grid"},Ce=["disabled"],we=["innerHTML"],De=O({__name:"index",setup(f){const t=J(),o=ce();K();const S=de(),g=u(!1),k=u(!1),x=u(!1),C=u(1),P=u(!0),d=u("supplier"),B=r(()=>{const e=t.mystores.find(n=>n.id===t.selectedId);return e?e.store_name:"Магазин не выбран"}),I=r(()=>{const e=o.partnerstores.find(n=>n.id===o.selectedSupplier);return e?e.partner_store_name:"Партнерский магазин не выбран"}),y=r(()=>t.selectedId!==null&&o.selectedSupplier!==null);r(()=>Math.ceil(S.totalSelectedProducts/10));const T=r(()=>t.statusRecommendations==="dbc_received"),V=r(()=>["GetStatisticsForNMIDs","SettingRecommendations"].includes(t.statusRecommendations));r(()=>t.statusRecommendations==="success"),r(()=>S.totalSelectedProducts>0);const E=r(()=>C.value===1?v.supplierSelection:C.value===2?v.stage1:T.value?v.stage2:V.value?v.stage3:""),R=async()=>{try{(await o.GetMyPartnerStores(1,50)).data.status==="ok"&&o.partnerstores.length>0?console.log("Партнерские магазины успешно загружены!"):h({type:"info",message:"Нет данных для отображения"})}catch(e){console.error("Ошибка при загрузке партнерских магазинов:",e),h({type:"error",message:"Произошла ошибка при загрузке партнерских магазинов"})}finally{P.value=!1}};function $(e){o.selectedSupplier=e,console.log("Выбран поставщик с ID:",e),setTimeout(()=>{d.value="confirm"},300)}function z(){d.value="supplier",o.selectedSupplier=null}function A(){if(!y.value){h({type:"warning",message:"Пожалуйста, выберите оба магазина"});return}t.statusRecommendations="dbc_received",F(),S.fetchData(o.selectedSupplier)}const F=()=>{t.dbc_category_drawer=!0},G=()=>{k.value=!0,x.value=!0,setTimeout(()=>{k.value=!1,x.value=!1},5e3)},L=()=>{};return Q(()=>{var e;((e=t.mystores)==null?void 0:e.length)===0&&t.GetMyStores(t.currentPage,50),R()}),(e,n)=>{const j=te,w=se,H=oe,U=ne,q=ae;return p(),m("div",_e,[a(pe,{title:"Создание карточек"},{right:i(()=>[s("div",fe,[a(j,{onClick:n[0]||(n[0]=c=>g.value=!0),size:"32",color:"warning"},{default:i(()=>[a(l(W))]),_:1})])]),_:1}),a(q,{class:"mt-4 mb-40 w-80"},{default:i(()=>[d.value!=="confirm"?(p(),X(me,{key:0,class:"mb-4"})):D("",!0),s("h3",null,_(d.value==="confirm"?"Подтвердите выбор":"Выберите поставщика"),1),a(Y,{name:"fade",mode:"out-in"},{default:i(()=>[d.value==="supplier"?(p(),m("div",ge,[s("div",ve,[(p(!0),m(Z,null,ee(l(o).partnerstores,c=>(p(),m("button",{key:c.id,onClick:Me=>$(c.id),class:M(["grid-button",{active:l(o).selectedSupplier===c.id}])},_(c.partner_store_name),11,Se))),128))])])):d.value==="confirm"?(p(),m("div",ye,[s("div",be,[s("div",null,[he,a(w,{type:"success"},{default:i(()=>[b(_(l(B)),1)]),_:1})]),s("div",null,[ke,a(w,{type:"warning"},{default:i(()=>[b(_(l(I)),1)]),_:1})])]),s("div",xe,[s("button",{onClick:z,class:"grid-button"},"Назад"),s("button",{onClick:A,disabled:!l(y),class:M(["grid-button",{active:l(y)}])},_(l(t).dbc_loading?"Подготовка":"Начать создание"),11,Ce)])])):D("",!0)]),_:1}),a(U,{modelValue:g.value,"onUpdate:modelValue":n[2]||(n[2]=c=>g.value=c),title:"Памятка",width:"500","align-center":""},{footer:i(()=>[a(H,{type:"primary",onClick:n[1]||(n[1]=c=>g.value=!1)},{default:i(()=>[b("Понятно")]),_:1})]),default:i(()=>[s("div",{innerHTML:l(E),class:"dialog-content"},null,8,we)]),_:1},8,["modelValue"]),a(ue,{onStage3:G,"onUpdate:selectedCategories":L})]),_:1})])}}});const tt=le(De,[["__scopeId","data-v-3b2d5123"]]);export{tt as default};
