import{d as $,$ as b,u as E,n as T,r as f,a0 as U,o as V,a1 as q,g as l,b as g,f as u,m as h,q as y,h as R,e as o,w as s,s as c,a2 as F,a3 as P,a4 as w,k as G,a5 as z,a6 as L,a7 as j,a8 as A,_ as H}from"./index-ff671c6d.js";/* empty css                      *//* empty css               */import J from"./SummaryStats-531ab0da.js";import{u as K}from"./useMyStoreStats-6b9c8885.js";import{changeTheme as k,chartData as S,updateChartData as M}from"./useMyStoreFunctions-ca38a5f5.js";import{_ as O}from"./CubeOverlay-af736554.js";/* empty css             */const Q={style:{height:"100vh"}},X={style:{"text-align":"center"}},Y={key:"chart",style:{height:"100%"},class:"w-90"},Z={key:"updating",class:"updating-overlay"},tt=$({__name:"StatsWidget",setup(et){const x=b();E();const e=K(),p=T(),n=f(null),C=f(!1),v=async()=>{e.mystoreStats={},e.statsFilter=!1},I=async()=>{const a=p.currentRoute.value,t=parseInt(a.query.storeId);isNaN(t)?(p.push("/mystores"),console.warn("Invalid or missing storeId in URL")):(await v(),await e.GetMyStoreStatistics(t,e.currentPage,1e3),await w(),n.value&&n.value.chart&&(await M(t,e.mode,e.period,n),console.log("Chart forcefully updated")))},D=()=>{console.log("Chart mounted"),C.value=!0};U(()=>{v()}),V(async()=>{console.log("Component mounted, loading data..."),C.value=!0,await I()});const _=f(!1),i=async a=>{_.value=!0,console.log("Updating chart data with mode:",a),a==="2W"||a==="3W"||a==="1M"?e.updatePeriod(a):e.updateMode(a);const t=p.currentRoute.value,r=parseInt(t.query.storeId);isNaN(r)||(await M(r,e.mode,e.period,n),k(n),await w(),_.value=!1)};return q(x,()=>{k(n)}),(a,t)=>{const r=G,m=z,N=L,B=j,W=A;return l(),g("div",Q,[u(e).loading?(l(),h(O,{key:0})):y("",!0),R("div",X,[o(F,{name:"slide-fade"},{default:s(()=>[u(e).statsFilter?(l(),h(W,{key:0,size:"large",class:"mt-4 mb-4"},{default:s(()=>[o(r,{onClick:t[0]||(t[0]=d=>i("openCardCount")),icon:"View"}),o(r,{onClick:t[1]||(t[1]=d=>i("addToCartCount")),icon:"ShoppingCart"}),o(r,{onClick:t[2]||(t[2]=d=>i("ordersCount")),icon:"CreditCard"}),o(B,{trigger:"click"},{dropdown:s(()=>[o(N,null,{default:s(()=>[o(m,{onClick:t[3]||(t[3]=d=>i("2W"))},{default:s(()=>[c("2Н")]),_:1}),o(m,{onClick:t[4]||(t[4]=d=>i("3W"))},{default:s(()=>[c("3Н")]),_:1}),o(m,{onClick:t[5]||(t[5]=d=>i("1M"))},{default:s(()=>[c("1M")]),_:1})]),_:1})]),default:s(()=>[o(r,{icon:"Filter"},{default:s(()=>[c(" Period")]),_:1})]),_:1})]),_:1})):y("",!0)]),_:1}),o(J)]),_.value?(l(),g("div",Z," Обновление... ")):(l(),g("div",Y,[o(u(P),{height:"100%",width:"100%",options:u(S).options,series:u(S).series,ref_key:"apexChart",ref:n,onMounted:D},null,8,["options","series"])]))])}}});const ut=H(tt,[["__scopeId","data-v-76dd229b"]]);export{ut as default};
